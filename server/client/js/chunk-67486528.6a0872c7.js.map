{"version":3,"sources":["webpack:///./src/components/admin/EditArticle.vue?3f1b","webpack:///./src/components/admin/EditArticle.vue?2313","webpack:///src/components/admin/EditArticle.vue","webpack:///./src/components/admin/EditArticle.vue?016b","webpack:///./src/components/admin/EditArticle.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","_v","_s","id","attrs","nativeOn","$event","preventDefault","save","model","value","callback","$$v","article","expression","$set","_l","item","key","_id","tag","picture","_e","$http","defaults","baseURL","getAuthHeaders","afterUpload","remove_img","staticClass","imgs","img","on","imgDel","ref","md_content","$imgAdd","staticRenderFns","props","data","istop","picture_url","tags","methods","res","url","created","fetch","fetchTags","component"],"mappings":"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","file":"js/chunk-67486528.6a0872c7.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditArticle.vue?vue&type=style&index=0&id=1708f3b6&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditArticle.vue?vue&type=style&index=0&id=1708f3b6&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',[_vm._v(_vm._s(_vm.id ? '编辑' : '新建')+\"文章\")]),_c('el-form',{attrs:{\"label-width\":\"50px\"},nativeOn:{\"submit\":function($event){$event.preventDefault();return _vm.save($event)}},model:{value:(_vm.article),callback:function ($$v) {_vm.article=$$v},expression:\"article\"}},[_c('el-form-item',{attrs:{\"label\":\"标题\"}},[_c('el-input',{model:{value:(_vm.article.title),callback:function ($$v) {_vm.$set(_vm.article, \"title\", $$v)},expression:\"article.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"标签\"}},[_c('el-select',{attrs:{\"multiple\":\"\",\"placeholder\":\"请选择\"},model:{value:(_vm.article.tags),callback:function ($$v) {_vm.$set(_vm.article, \"tags\", $$v)},expression:\"article.tags\"}},_vm._l((_vm.tags),function(item){return _c('el-option',{key:item._id,attrs:{\"label\":item.tag,\"value\":item._id}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"置顶\"}},[_c('el-radio',{attrs:{\"label\":true},model:{value:(_vm.article.istop),callback:function ($$v) {_vm.$set(_vm.article, \"istop\", $$v)},expression:\"article.istop\"}},[_vm._v(\"Yes\")]),_c('el-radio',{attrs:{\"label\":false},model:{value:(_vm.article.istop),callback:function ($$v) {_vm.$set(_vm.article, \"istop\", $$v)},expression:\"article.istop\"}},[_vm._v(\"No\")])],1),(_vm.id)?_c('el-form-item',{attrs:{\"label\":\"已上传图片\",\"label-width\":\"90px\"}},[_c('el-image',{attrs:{\"src\":_vm.article.picture,\"fit\":\"cover\"}})],1):_vm._e(),_c('el-form-item',{attrs:{\"label\":\"图片\"}},[_c('el-upload',{attrs:{\"action\":_vm.$http.defaults.baseURL + '/upload/card_img',\"list-type\":\"picture-card\",\"headers\":_vm.getAuthHeaders(),\"on-success\":_vm.afterUpload,\"on-remove\":_vm.remove_img,\"limit\":1}},[_c('i',{staticClass:\"el-icon-plus\"})])],1),(_vm.imgs.length)?_c('el-form-item',{attrs:{\"label\":\"文章图片\",\"label-width\":\"77px\"}},_vm._l((_vm.imgs),function(img){return _c('div',{key:img,staticClass:\"imgs\"},[_c('el-image',{attrs:{\"src\":img,\"fit\":\"cover\"}}),_c('el-button',{staticClass:\"el-icon-delete\",attrs:{\"type\":\"danger\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.imgDel(img)}}})],1)}),0):_vm._e(),_c('el-form-item',{attrs:{\"label\":\"内容\"}},[_c('mavon-editor',{ref:\"md\",attrs:{\"codeStyle\":\"monokai\",\"value\":this.article.md_content},on:{\"imgAdd\":_vm.$imgAdd}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"native-type\":\"submit\"}},[_vm._v(\"保存\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!-- 编辑文章 -->\r\n<template>\r\n  <div>\r\n    <h1>{{ id ? '编辑' : '新建' }}文章</h1>\r\n    <el-form label-width=\"50px\" v-model=\"article\" @submit.native.prevent=\"save\">\r\n      <el-form-item label=\"标题\">\r\n        <el-input v-model=\"article.title\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"标签\">\r\n        <el-select v-model=\"article.tags\" multiple placeholder=\"请选择\">\r\n          <el-option v-for=\"item in tags\" :key=\"item._id\" :label=\"item.tag\" :value=\"item._id\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"置顶\">\r\n        <el-radio v-model=\"article.istop\" :label=true>Yes</el-radio>\r\n        <el-radio v-model=\"article.istop\" :label=false>No</el-radio>\r\n      </el-form-item>\r\n      <el-form-item v-if=\"id\" label=\"已上传图片\" label-width=\"90px\">\r\n        <el-image :src=\"article.picture\" fit=\"cover\"></el-image>\r\n      </el-form-item>\r\n      <el-form-item label=\"图片\">\r\n        <el-upload\r\n          :action=\"$http.defaults.baseURL + '/upload/card_img'\"\r\n          list-type=\"picture-card\"\r\n          :headers=\"getAuthHeaders()\"\r\n          :on-success=\"afterUpload\"\r\n          :on-remove=\"remove_img\"\r\n          :limit=\"1\"\r\n        >\r\n          <i class=\"el-icon-plus\"></i>\r\n        </el-upload>\r\n      </el-form-item>\r\n      <el-form-item v-if=\"imgs.length\" label=\"文章图片\" label-width=\"77px\">\r\n        <div v-for=\"img in imgs\" :key=\"img\" class=\"imgs\">\r\n          <el-image :src=\"img\" fit=\"cover\"></el-image>\r\n          <el-button class=\"el-icon-delete\" @click=\"imgDel(img)\" type=\"danger\" size=\"mini\"></el-button>\r\n        </div>\r\n      </el-form-item>\r\n      <el-form-item label=\"内容\">\r\n        <!-- mavonEditor -->\r\n        <mavon-editor\r\n          ref=\"md\"\r\n          codeStyle=\"monokai\"\r\n          @imgAdd=\"$imgAdd\"\r\n          :value=\"this.article.md_content\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" native-type=\"submit\">保存</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    id: {}\r\n  },\r\n  data() {\r\n    return {\r\n      article: {\r\n        istop: false\r\n      },\r\n      imgs: [],\r\n      picture_url: \"\",\r\n      tags: []\r\n    };\r\n  },\r\n  methods: {\r\n    // 上传图片之后，返回url\r\n    afterUpload(res) {\r\n      this.$set(this.article, \"picture\", res.url);\r\n    },\r\n    // 保存文章，有id为编辑文章，否则为新建文章，实现组件复用\r\n    async save() {\r\n      this.$set(this.article, \"html_content\", this.$refs.md.d_render); // html\r\n      this.$set(this.article, \"md_content\", this.$refs.md.d_value); //md\r\n      this.$set(this.article, \"imgs\", this.imgs); //imgs\r\n      this.$set(this.article, \"date\", this.article.date || this.dateFormat()); //date\r\n      // this.$set(this.article, \"date\", this.dateFormat()); //date\r\n      this.$set(this.article, \"pageviews\", this.article.pageviews || 1); //pageviews\r\n      if (this.id) {\r\n        // 删除已上传图片\r\n        if (this.picture_url != this.article.picture) {\r\n          let img_name = this.img_name(this.picture_url);\r\n          await this.$http.delete(`upload/del/card_img/${img_name}`);\r\n        }\r\n        await this.$http.put(`admin/common/articles/${this.id}`, this.article);\r\n      } else {\r\n        await this.$http.post(\"admin/common/articles\", this.article);\r\n      }\r\n      this.$router.push(\"/admin/article-list\");\r\n      this.$message({\r\n        type: \"success\",\r\n        message: \"保存成功\"\r\n      });\r\n    },\r\n    // remove_img\r\n    async remove_img() {\r\n      let img_name = this.img_name(this.article.picture);\r\n      await this.$http.delete(`upload/del/card_img/${img_name}`);\r\n    },\r\n    // 获取修改文章信息\r\n    async fetch() {\r\n      const res = await this.$http.get(`admin/common/articles/${this.id}`);\r\n      this.article = res.data;\r\n      this.imgs = this.article.imgs;\r\n      this.picture_url = this.article.picture;\r\n    },\r\n    // 获取标签\r\n    async fetchTags() {\r\n      const res = await this.$http.get(\"admin/common/tags\");\r\n      this.tags = res.data;\r\n    }\r\n  },\r\n  created() {\r\n    this.id && this.fetch();\r\n    this.fetchTags();\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.el-image {\r\n  height: 150px;\r\n  width: 150px;\r\n  margin: 10px;\r\n}\r\n.imgs {\r\n  float: left;\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditArticle.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditArticle.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./EditArticle.vue?vue&type=template&id=1708f3b6&scoped=true&\"\nimport script from \"./EditArticle.vue?vue&type=script&lang=js&\"\nexport * from \"./EditArticle.vue?vue&type=script&lang=js&\"\nimport style0 from \"./EditArticle.vue?vue&type=style&index=0&id=1708f3b6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1708f3b6\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}